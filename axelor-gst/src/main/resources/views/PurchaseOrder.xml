<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">


	<form name="purchase-order-form" title="Supplier RFQ/PO"
		model="com.axelor.apps.purchase.db.PurchaseOrder"
		onLoad="action-group-purchase-order-on-load-actions"
		onNew="action-group-purchase-order-on-new-actions" id="purchase-order-form-id">
		<menubar>
			<menu title="Reports" icon="fa-files-o" showTitle="true">
				<item title="Print"
					action="save,action-purchase-order-method-show-purchase-order"
					hideIf="supplierPartner == null" />
			</menu>
			<menu title="Tools" icon="fa-wrench" showTitle="true">
				<item name="sendEmailBtn" title="Send email"
					action="save,action-send-by-email-with-template"
					hideIf="supplierPartner == null" />
				<item name="cancelReceiptBtn" title="Cancel receipt"
					showIf="statusSelect &gt;= 3"
					action="save,action-purchase-order-method-cancel-receipt"
					hideIf="supplierPartner == null" />
			</menu>
		</menubar>
		<panel name="overviewPanel">
			<field name="statusSelect" showTitle="false" widget="NavSelect"
				colSpan="12" readonly="true" />
			<panel name="mainPanel" readonlyIf="statusSelect == 4"
				colSpan="12">
				<field name="purchaseOrderSeq" showTitle="false" colSpan="10">
					<viewer depends="statusSelect,purchaseOrderSeq"><![CDATA[
	          <h3>
	           <span ng-show="[1,2,5].includes(record.statusSelect) &amp;&amp; record.purchaseOrderSeq" x-translate>Quotation</span>
	           <span ng-show="[3,4].includes(record.statusSelect)" x-translate>Purchase order</span>
	           {{record.purchaseOrderSeq}}
	          </h3>
	       ]]></viewer>
				</field>
				<field name="receiptState" showTitle="false"
					showIf="statusSelect == 3 || statusSelect == 4"
					css="label-bold bold" colSpan="2">
					<viewer><![CDATA[
	          <span class="label label-important" ng-show="record.receiptState == 1" x-translate>Not received</span>
	          <span class="label label-warning" ng-show="record.receiptState == 2" x-translate>Partially received</span>
	          <span class="label label-success" ng-show="record.receiptState == 3" x-translate>Received</span>
	        ]]></viewer>
				</field>
				<field name="company" canEdit="false" colSpan="3"
					widget="SuggestBox"
					onChange="action-group-purchase-order-company-change-actions"
					form-view="company-form" grid-view="company-grid"
					readonlyIf="statusSelect >= 3 || supplierPartner != null" />
				<field name="supplierPartner" canEdit="false"
					hideIf="company == null" colSpan="3"
					onChange="action-group-purchase-order-partner-onchange"
					readonlyIf="purchaseOrderLineList.length > 0 || statusSelect >= 3"
					onSelect="action-set-supplier-partner-domain"
					form-view="partner-form" grid-view="partner-grid" />
				<field name="currency" canEdit="false" colSpan="3"
					form-view="currency-form" grid-view="currency-grid"
					readonlyIf="statusSelect >= 3" />
				<field name="priceList"
					onSelect="action-purchase-order-method-price-list-domain"
					colSpan="3" readonlyIf="statusSelect >= 3"
					form-view="price-list-form" grid-view="price-list-grid"
					hideIf="company == null" />
				<field name="contactPartner"
					onChange="action-record-po-contact-partner-change"
					onSelect="action-attrs-po-domain-on-contact-partner"
					domain="self.isContact = true" form-view="partner-contact-form"
					grid-view="partner-contact-grid" hideIf="company == null" />
				<field name="versionNumber"
					if="__config__.app.getApp('purchase').getManagePurchaseOrderVersion()"
					colSpan="3" />
				<panel name="inAtiAndIntercoPanel" colSpan="3">
					<field name="inAti"
						onChange="action-purchase-order-attrs-in-ati"
						readonlyIf="purchaseOrderLineList.length > 0 || statusSelect >= 3" />
					<field name="interco" hidden="true"
						if-module="axelor-supplychain"
						if="__config__.app.isApp('supplychain')" />
					<field name="createdByInterco" showIf="createdByInterco"
						readonly="true" if-module="axelor-supplychain"
						if="__config__.app.isApp('supplychain')" />
				</panel>
				<field name="supplierPartner.purchaseOrderInformation"
					css="bold red" colSpan="12" showTitle="false"
					hideIf="supplierPartner == null || supplierPartner.purchaseOrderInformation == null" />
			</panel>
		</panel>
		<panel-tabs name="mainPanelTab"
			hideIf="supplierPartner == null">
			<panel name="contentPanel" title="Content" colSpan="12">
				<panel-related name="purchaseOrderLineListPanel"
					field="purchaseOrderLineList" canNew="statusSelect &lt; 3"
					canRemove="statusSelect &lt; 3" readonlyIf="statusSelect == 4"
					grid-view="purchase-order-line-purchase-order-grid"
					title="PO lines detail" colSpan="12"
					onChange="action-purchase-order-method-compute"
					form-view="purchase-order-line-form" canMove="true"
					orderBy="sequence" />
				<field name="notes" colSpan="12" x-lite="true" widget="html" />
			</panel>
			<panel name="taxPanel" title="Tax" colSpan="12">
				<panel-related name="purchaseOrderLineTaxListPanel"
					field="purchaseOrderLineTaxList" readonly="true" title="Tax Lines"
					colSpan="12" grid-view="purchase-order-line-tax-grid"
					form-view="purchase-order-line-tax-form" />
			</panel>
			<panel name="deliveryPanel" title="Delivery" colSpan="12">
				<field name="deliveryDate" colSpan="3"
					onChange="action-purchase-order-method-update-purchase-order-lines-estimated-deliv-date" />
				<field name="stockLocation" canEdit="false"
					domain="self.company = :company and self.typeSelect in (1,2) and self.usableOnPurchaseOrder = true"
					if-module="axelor-supplychain" colSpan="3"
					form-view="stock-location-form" grid-view="stock-location-grid"
					if="__config__.app.isApp('supplychain')" />
				<field name="stockLocation.address"
					if-module="axelor-supplychain" form-view="address-form"
					grid-view="address-grid" if="__config__.app.isApp('supplychain')" />
				<field name="shipmentMode" if-module="axelor-stock"
					form-view="shipment-mode-form" grid-view="shipment-mode-grid"
					onChange="action-purchase-order-record-empty-freight-carrier-mode"
					if="__config__.app.isApp('stock')" />
				<field name="freightCarrierMode"
					domain="self.shipmentMode = :shipmentMode" if-module="axelor-stock"
					form-view="freight-carrier-mode-form"
					grid-view="freight-carrier-mode-grid"
					if="__config__.app.isApp('stock')" />
				<panel-dashlet name="POStockMovesPanel" colSpan="12"
					action="action-purchase-order-view-stock-moves" height="178"
					showIf="statusSelect >= 3" />
			</panel>
			<panel name="projectPanel"
				if="__config__.app.isApp('business-project') &amp;&amp; __config__.app.getApp('business-project').getGenerateProjectOrder()"
				title="Business project" colSpan="12"
				if-module="axelor-business-project">
				<field name="project" domain="self.isBusinessProject = true"
					form-view="project-form" grid-view="project-grid" colSpan="6" />
				<button name="updateLinesBtn"
					title="Update lines with selected project"
					onClick="save,action-business-project-purchase-order-method-update-lines,save"
					colSpan="6" readonlyIf="!project" />
			</panel>
			<panel name="POManagementPanel" title="PO Management"
				if-module="axelor-supplier-management" colSpan="12"
				if="__config__.app.getApp('purchase').getSupplierRequestMgt()">
				<panel-include view="purchase-order-supplier-form"
					from="axelor-supplier-management" />
			</panel>
			<panel name="timetablePanel" title="Timetable"
				if-module="axelor-supplychain"
				if="__config__.app.isApp('supplychain')">
				<field name="expectedRealisationDate" colSpan="12" width="50%" />
				<label name="orLabel" title="OR" />
				<field name="amountToBeSpreadOverTheTimetable" colSpan="12" />
				<panel-related name="timetableListPanel"
					field="timetableList" colSpan="12" grid-view="timetable-grid"
					form-view="timetable-form"
					onChange="action-purchase-order-method-update-amount-to-be-spread-over-the-timetable"
					if-module="axelor-supplychain" />
			</panel>
			<panel name="budgetDistributionPanel"
				title="Budget distribution" if="__config__.app.isApp('budget')"
				showIf="statusSelect &lt;= 2" if-module="axelor-supplychain">
				<field name="budget" />
				<button name="applyToAllBtn" title="Apply to all"
					onClick="save,action-purchase-order-budget-distribution-apply-to-all"
					readonlyIf="!budget" />
			</panel>
			<panel name="printingPanel" title="Printing">
				<field name="printingSettings"
					onSelect="action-purchase-order-method-filter-printing-settings"
					canEdit="false" />
				<field name="priceDisplay" colSpan="12" />
				<field name="priceRequest" hideIf="priceDisplay" colSpan="12"
					x-height="5" />
			</panel>
			<panel name="invoicingPanel" title="Invoicing"
				hideIf="statusSelect &lt; 3">
				<field if="__config__.app.isApp('invoice')"
					if-module="axelor-account" name="invoice" form-view="invoice-form"
					grid-view="invoice-grid" />
				<panel-dashlet name="POInvoicesPanel"
					action="action-view-show-invoices-from-purchase-order"
					title="Invoices" if-module="axelor-supplychain"
					if="__config__.app.isApp('supplychain')"
					showIf="statusSelect &gt;= 3" colSpan="12" />
			</panel>

		</panel-tabs>

		<panel name="attrsPanel">
			<field name="attrs" colSpan="12" />
		</panel>

		<panel sidebar="true" name="actionsPanel"
			hideIf="statusSelect == 4 || supplierPartner == null">
			<button name="draftBtn" title="Draft"
				showIf="statusSelect == 5"
				onClick="action-purchase-order-record-draft,save" />
			<button name="requestedBtn" title="Requested"
				showIf="statusSelect == 1"
				onClick="save,action-purchase-order-method-requested" />
			<button name="newVersionBtn" title="New version"
				showIf="statusSelect == 2"
				onClick="save,action-purchase-record-newVersion,save"
				if="__config__.app.getApp('purchase').getManagePurchaseOrderVersion()" />
			<button name="validateBtn" title="Validate"
				showIf="statusSelect == 2"
				onClick="action-group-purchase-order-on-validate-actions" />
			<button name="generateSupplierStockMoveBtn"
				title="Generate supplier arrival"
				showIf="statusSelect == 3 || statusSelect == 4"
				if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').getSupplStockMoveMgtOnPO() &amp;&amp; !__config__.app.getApp('supplychain').getSupplierStockMoveGenerationAuto()"
				onClick="save,action-purchase-order-create-stock-move"
				if-module="axelor-supplychain" />
			<button name="generateInvoiceBtn"
				title="Generate control invoice" showIf="statusSelect == 3"
				onClick="save,action-purchase-order-method-generate-control-invoice"
				if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').generateInvoiceFromPurchaseOrder"
				if-module="axelor-supplychain" />
			<button name="showInvoiceBtn" title="Show invoice"
				showIf="statusSelect == 3 || statusSelect == 4"
				onClick="action-purchase-order-show-invoice"
				if-module="axelor-supplychain"
				if="__config__.app.isApp('supplychain')" />
			<button name="finishManuallyPurchaseOrderBtn"
				title="Finish the order"
				prompt="Warning, a completed order can't be changed anymore, do you want to continue?"
				showIf="statusSelect == 3"
				if="(__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain')?.allowFinishManuallyPurchaseOrder) || (!__config__.app.isApp('supplychain'))"
				onClick="save,action-purchase-order-method-finish-purchase-order"
				if-module="axelor-supplychain" />
			<spacer name="btnSpacer" />
			<button name="cancelBtn" title="Cancel" css="btn-danger"
				icon="fa-times"
				showIf="statusSelect &lt;= 3  || invoice.statusSelect &lt;= 2"
				onClick="save,action-group-purchase-order-cancel" />
		</panel>

		<panel name="intaxTotalPanel" sidebar="true"
			hideIf="supplierPartner == null">
			<separator />
			<field name="inTaxTotal" css="order-subtotal" showTitle="false"
				colSpan="12">
				<viewer
					depends="exTaxTotal,currency.symbol,taxTotal,amountInvoiced">
                    <![CDATA[
                    <dl class="dl-horizontal">
                        <dt x-translate>Total W.T.</dt>
                        <dd>{{record.exTaxTotal}}  {{record.currency.symbol}}</dd>
                        <dt x-translate>Total tax</dt>
                        <dd>{{record.taxTotal}}  {{record.currency.symbol}}</dd>
                        <dt class="order-subtotal-total" x-translate>Total A.T.I.</dt>
                        <dd class="order-subtotal-total">{{record.inTaxTotal}}  {{record.currency.symbol}}</dd>
                        <dt x-translate>Amount invoiced W.T.</dt>
                        <dd>{{record.amountInvoiced}}  {{record.currency.symbol}}</dd>
                    </dl>
                    ]]>
                </viewer>
			</field>
		</panel>

		<panel sidebar="true" title="GST Computation" itemSpan="6">
			<field name="netAmount" colSpan="6" />
			<field name="netIgst" colSpan="6" />
			<field name="netCgst" colSpan="6" />
			<field name="netSgst" colSpan="6" />
			<field name="grossAmount" colSpan="6" />
		</panel>
		<panel name="purchasesFollowUpPanel" title="Purchases follow-up"
			hideIf="supplierPartner == null" sidebar="true" itemSpan="6"
			canCollapse="true" collapseIf="true">
			<field name="buyerUser" canNew="false" canEdit="false"
				canView="false" form-view="user-form" grid-view="user-grid" />
			<field if="__config__.app.getApp('base').getTeamManagement()"
				name="team" canEdit="false" form-view="team-form"
				grid-view="team-grid" />
			<field name="tradingName" canEdit="false"
				grid-view="trading-name-grid" form-view="trading-name-form"
				if="__config__.app.getApp('base').enableTradingNamesManagement"
				readonlyIf="statusSelect >= 3"
				domain=":company MEMBER OF self.companySet"
				onChange="action-purchase-order-method-printing-settings-default-value" />
		</panel>
		<panel name="datesPanel" title="Dates" sidebar="true"
			hideIf="supplierPartner == null" readonlyIf="statusSelect == 4"
			itemSpan="6" canCollapse="true" collapseIf="true">
			<field name="orderDate" />
			<spacer name="orderDateSpacer" />
			<field name="validationDate" />
			<field name="validatedByUser" canNew="false" canEdit="false"
				canView="false" form-view="user-form" grid-view="user-grid" />
		</panel>
		<panel name="referencesPanel" title="References"
			hideIf="supplierPartner == null" sidebar="true" itemSpan="6"
			canCollapse="true" collapseIf="true">
			<field name="externalReference" hideIf="company == null"
				onChange="action-purchase-order-attrs-external-reference" />
			<field name="internalReference" />
			<field name="duplicateReferenceLabel" showTitle="false"
				readonly="true" hidden="true">
				<viewer>
          <![CDATA[
            <h5>
              <span ng-show="true" class='label label-warning' x-translate>Reference already existing</span>
            </h5>
          ]]>
				</viewer>
			</field>
		</panel>
		<panel name="characteristicsPanel" title="Characteristics"
			sidebar="true" hideIf="supplierPartner == null" canCollapse="true"
			collapseIf="true">
			<field name="paymentMode" canEdit="false"
				domain="self.inOutSelect = 2"
				onChange="action-purchase-order-method-fill-company-bank-details"
				if-module="axelor-account" form-view="payment-mode-form"
				grid-view="payment-mode-grid"
				if="__config__.app.isApp('supplychain')" colSpan="6" />
			<field name="paymentCondition" canEdit="false"
				if-module="axelor-account" form-view="payment-condition-form"
				grid-view="payment-condition-grid"
				if="__config__.app.isApp('supplychain')" colSpan="6" />
			<field name="companyBankDetails" widget="SuggestBox"
				onSelect="action-invoice-attrs-domain-company-bank-details"
				form-view="bank-details-form" grid-view="bank-details-grid"
				if="__config__.app.getApp('base').getManageMultiBanks()"
				if-module="axelor-cash-management" />
		</panel>
		<panel name="internalNotePanel" title="Internal note"
			sidebar="true">
			<field name="internalNote" colSpan="12" x-lite="true"
				widget="html" showTitle="false" />
		</panel>
		<panel-mail name="mailPanel">
			<mail-messages limit="4" />
			<mail-followers />
		</panel-mail>

	</form>

</object-views>
