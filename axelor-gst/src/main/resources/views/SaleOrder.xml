<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">


	<form id="sale-order-form-id" name="sale-order-form" title="Sale order" model="com.axelor.apps.sale.db.SaleOrder" onLoad="action-group-sale-saleorder-onload" onNew="action-group-sale-saleorder-onnew">
	  <menubar>
	    <menu title="Reports">
	      <item title="Print" hideIf="clientPartner == null" action="save,action-sale-order-method-show-sale-order"/>
	      <item title="Print proforma invoice" hideIf="clientPartner == null" action="save,action-sale-order-method-print-proforma-invoice"/>
	      <item title="Excel Export" hideIf="clientPartner == null" action="save,action-sale-order-method-export-sale-order-excel"/>
	      <item title="Word Export" hideIf="clientPartner == null" action="save,action-sale-order-method-export-sale-order-word"/>
	    </menu>
	    <menu title="Tools">
	      <item title="Schedule Event" hideIf="clientPartner == null" action="action-sale-order-view-schedule-event"/>
	      <item title="Send email" hideIf="clientPartner == null" action="save,action-send-by-email-with-template"/>
	      <item title="Define as template" hideIf="clientPartner == null" action="save,action-sale-order-method-generate-template"/>
        <item title="Allocate all" action="save,action-sale-order-method-allocate-all" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" if="__config__.app.getApp('supplychain')?.manageStockReservation"/>
        <item title="Deallocate all" action="save,action-sale-order-method-deallocate-all" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" if="__config__.app.getApp('supplychain')?.manageStockReservation"/>
				<item title="Reserve all" action="save,action-sale-order-method-reserve-all" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" if="__config__.app.getApp('supplychain')?.manageStockReservation"/>
        <item title="Cancel reservation" action="save,action-sale-order-method-cancel-reservation" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" if="__config__.app.getApp('supplychain')?.manageStockReservation"/>
	    </menu>
	  </menubar>
	  <panel name="mainPanel">
	    <panel name="blockedCustCreditExceedPanel" colSpan="12">
	      <field name="blockedOnCustCreditExceed" showTitle="false" readonly="true" showIf="blockedOnCustCreditExceed &amp;&amp; !manualUnblock" colSpan="4">
	        <viewer depends="blockedOnCustCreditExceed"><![CDATA[
	          <h5>
	            <span class="label label-default" style="background-color: #B6473F; margin: 0px 0 !important; display: inline-table; line-height: initial;" ng-show="record.blockedOnCustCreditExceed" x-translate>Blocked</span>
	          </h5>
	        ]]></viewer>
	      </field>
	      <button name="manualUnblockBtn" title="Manual Unblock" showIf="blockedOnCustCreditExceed == true &amp;&amp; manualUnblock == false" colSpan="4" css="btn-custom" onClick="action-sale-order-manual-unblock"/>
	      <field name="manualUnblock" hidden="true"/>
	      <field name="orderBeingEdited" hidden="true"/>
	      <field name="$viewerOrderBeingEdited" showTitle="false" readonly="true" showIf="orderBeingEdited" colSpan="9">
	        <viewer depends="orderBeingEdited"><![CDATA[
	          <h4>
	            <span class="label label-important" ng-show="record.orderBeingEdited" x-translate>Order being edited</span>
	          </h4>
	        ]]></viewer>
	      </field>
	    </panel>
	    <field name="statusSelect" showTitle="false" colSpan="12" widget="NavSelect"/>
	    <field name="saleOrderSeq" showTitle="false">
		    <viewer depends="statusSelect,saleOrderSeq"><![CDATA[
		      <h3>
		        <span ng-show="[1,2,5].includes(record.statusSelect) &amp;&amp; record.saleOrderSeq" x-translate>Quotation</span>
		        <span ng-show="[3,4].includes(record.statusSelect)" x-translate>Sale order</span>
		        {{record.saleOrderSeq}}
		      </h3>
		    ]]></viewer>
		  </field>
	    <panel name="detailsPanel" colSpan="12">
	      <field name="saleOrderTypeSelect" colSpan="3" css="label-bold bold" showTitle="false" readonlyIf="statusSelect >= 2" if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').getAllowSusbcriptionSaleOrder()" if-module="axelor-supplychain">
	        <viewer><![CDATA[
	          <div>
	            <div class="span7">
	              <h5>
	                <span class="label label-info">
	                <span ng-show="record.saleOrderTypeSelect == 1" x-translate>Standard</span>
	                <span ng-show="record.saleOrderTypeSelect == 2" x-translate>Subscription</span>
	              </h5>
	            </div>
	          </div>
	        ]]></viewer>
	      </field>
	      <field name="$invoicingState" showTitle="false" readonly="true" showIf="statusSelect >= 3" css="label-bold bold" colSpan="3">
	        <viewer depends="amountInvoiced,exTaxTotal"><![CDATA[
	        <div>
	        <div class="span7">
	          <h5>
	          <span class="label label-important" ng-show="record.amountInvoiced == 0"  x-translate>Not invoiced</span>
	          <span class="label label-warning" ng-show="record.amountInvoiced > 0 && $number(record.amountInvoiced) < $number(record.exTaxTotal)" x-translate>Partially invoiced</span>
	          <span class="label label-success" ng-show="record.amountInvoiced > 0 && $number(record.amountInvoiced) >= $number(record.exTaxTotal)" x-translate>Invoiced</span>
	        </h5>
	        </div>
	      </div>
	      ]]></viewer>
	      </field>
	      <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" showTitle="false" name="deliveryState" showIf="statusSelect >= 3" css="label-bold bold" colSpan="3">
	        <viewer><![CDATA[
	        <div>
	        <div class="span7">
	        <h5>
	          <span class="label label-important" ng-show="record.deliveryState == 1" x-translate>Not delivered</span>
	          <span class="label label-warning" ng-show="record.deliveryState == 2" x-translate>Partially delivered</span>
	          <span class="label label-success" ng-show="record.deliveryState == 3" x-translate>Delivered</span>
	        </h5>
	        </div>
	      </div>
	      ]]></viewer>
	      </field>
	      <field name="availabilityRequestLabel" colSpan="3" css="label-bold bold" showTitle="false" readonly="true" hidden="true">
	        <viewer><![CDATA[
	          <div>
	            <div class="span7">
	              <h5>
	                <span class="label label-important">
	                <span x-translate>Availability Request</span>
	              </h5>
	            </div>
	          </div>
	        ]]></viewer>
	      </field>
	  	</panel>
	    <panel name="generalInfoPanel" colSpan="12">
	      <field name="company" readonlyIf="statusSelect == 3 || clientPartner != null" widget="SuggestBox" canEdit="false" onChange="action-sale-group-onchange-company" form-view="company-form" grid-view="company-grid" colSpan="3"/>
	      <field if="__config__.app.getApp('base').enableTradingNamesManagement" name="tradingName" readonlyIf="statusSelect >= 2" canEdit="false" onChange="action-sale-method-printing-settings-default-values" domain=":company MEMBER OF self.companySet" form-view="trading-name-form" grid-view="trading-name-grid" colSpan="3"/>
	      <label name="tradingNameLabel" if="!(__config__.app.getApp('base').enableTradingNamesManagement)" colSpan="3" />
	      <field name="currency" readonlyIf="saleOrderLineList.length > 0 || statusSelect >= 2" canEdit="false" form-view="currency-form" grid-view="currency-grid" colSpan="3"/>
	      <field name="priceList" readonlyIf="saleOrderLineList.length > 0 || statusSelect >= 2" onChange="action-sale-order-record-hide-discount" onSelect="action-sale-order-method-price-list-domain" form-view="price-list-form" grid-view="price-list-grid" hideIf="company == null" colSpan="3"/>
	      <field name="clientPartner" hideIf="company == null" readonlyIf="saleOrderLineList.length > 0 || statusSelect >= 2" onChange="action-sale-order-group-client-partner-change,action-sale-order-record-compute-end-of-validity-date" onSelect="action-set-client-partner-domain" form-view="partner-form" grid-view="partner-grid" colSpan="3"/>
	      <field name="contactPartner" colSpan="3" hideIf="company == null" onChange="action-record-so-contact-partner-change" onSelect="action-sale-order-domain-on-contact-partner" domain="self.isContact = true" form-view="partner-contact-form" grid-view="partner-contact-grid"/>
	      <field if="__config__.app.getApp('sale').getManageSaleOrderVersion()" name="versionNumber" colSpan="3"/>
	      <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" colSpan="3" name="directOrderLocation" onChange="action-sale-order-record-direct-order-location-onchange" widget="boolean-switch"/>
	      <panel name="otherInfoPanel" colSpan="3">
	        <field name="inAti" hidden="true" readonlyIf="saleOrderLineList.length > 0 || statusSelect &gt;= 2" onChange="action-sale-order-attrs-in-ati" widget="boolean-switch"/>
	        <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" hidden="true" colSpan="6" name="interco" widget="boolean-switch"/>
	        <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" colSpan="6" readonly="true" showIf="createdByInterco" name="createdByInterco"/>
	    	</panel>
	    </panel>
	    <panel name="addressPanel" colSpan="12" hideIf="company == null">
	      <panel name="mainInvoicingAddressPanel" stacked="true">
	        <field name="mainInvoicingAddress" hideIf="$readonly() || (statusSelect > 1 &amp;&amp; !orderBeingEdited)" canNew="true" onChange="action-sale-order-method-address-str" onSelect="action-sale-order-attrs-domain-main-invoicing-address" form-view="address-partner-address-form" grid-view="address-grid"/>
	        <field name="mainInvoicingAddressStr" readonlyIf="statusSelect > 1 &amp;&amp; !orderBeingEdited" height="5">
	          <viewer><![CDATA[{{record.mainInvoicingAddressStr}}]]></viewer>
	        </field>
	      </panel>
	      <panel name="deliveryAddressPanel" stacked="true">
	        <field name="deliveryAddress" hideIf="$readonly() || (statusSelect > 1 &amp;&amp; !orderBeingEdited)" canNew="true" onChange="action-sale-order-method-address-str,action-sale-order-attrs-set-is-ispm-required" onSelect="action-sale-order-attrs-domain-delivery-address" form-view="address-partner-address-form" grid-view="address-grid"/>
	        <field name="deliveryAddressStr" readonlyIf="statusSelect > 1 &amp;&amp; !orderBeingEdited" height="5">
	          <viewer><![CDATA[{{record.deliveryAddressStr}}]]></viewer>
	        </field>
	      </panel>
	    </panel>
	    <field name="clientPartner.saleOrderInformation" showTitle="false" hideIf="clientPartner == null || clientPartner.saleOrderInformation == null" colSpan="12" css="bold red"/>
	  </panel>
	  <panel-tabs name="mainPanelTab" hideIf="clientPartner == null">
	    <panel name="contentPanel" title="Content">
	      <panel-related name="detailLinesPanel" canRemove="!(clientPartner == null || statusSelect == 2 || (statusSelect == 3 &amp;&amp; !orderBeingEdited) || statusSelect == 4)" 
                     canNew="!(clientPartner == null || statusSelect == 2 || (statusSelect == 3 &amp;&amp; !orderBeingEdited) || statusSelect == 4)" title="Details Lines" readonlyIf="clientPartner == null" colSpan="12" field="saleOrderLineList" form-view="sale-order-line-form" grid-view="sale-order-line-grid" orderBy="sequence" onChange="action-sale-order-line-change-group" canMove="true"/>
	      <panel name="descriptionPanel" title="Description to display" colSpan="12">
	        <field name="description" showTitle="false" colSpan="12" widget="Html" x-lite="true"/>
	      </panel>
	    </panel>
	    <panel name="taxPanel" title="Tax">
	      <panel-related name="saleOrderLineTaxListPanel" colSpan="12" field="saleOrderLineTaxList" form-view="sale-order-line-tax-form" grid-view="sale-order-line-tax-grid"/>
	    </panel>
	    <panel if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" name="deliveryInformationPanel" title="Delivery information" colSpan="12">
	      <field name="specificPackage" colSpan="12"/>
	      <field name="stockLocation" canEdit="false" onSelect="action-sale-order-attrs-set-stock-location-domain" form-view="stock-location-form" grid-view="stock-location-grid"/>
	      <field name="deliveryDate" onChange="action-sale-order-method-fill-sale-order-lines-estimated-date"/>
	      <field name="deliveryCondition" colSpan="12"/>
	      <field name="shipmentMode" form-view="shipment-mode-grid" grid-view="shipment-mode-grid"/>
	      <field name="freightCarrierMode" onChange="action-sale-order-record-freight-carrier" domain="self.shipmentMode = :shipmentMode" form-view="freight-carrier-mode-form" grid-view="freight-carrier-mode-grid"/>
	      <field name="carrierPartner" canEdit="false" domain="self.isCarrier = TRUE AND (self.companySet IS EMPTY OR :company MEMBER OF self.companySet)" form-view="partner-form" grid-view="partner-grid"/>
	      <field name="forwarderPartner" canEdit="false" domain=":company MEMBER OF self.companySet" form-view="partner-form" grid-view="partner-grid"/>
	      <field name="incoterm" canEdit="false" form-view="incoterm-form" grid-view="incoterm-grid"/>
	      <field name="isNeedingConformityCertificate" colSpan="3"/>
	      <field name="isIspmRequired" readonly="true" colSpan="3"/>
	      <button name="customerDeliveriesDetailsBtn" title="Customer deliveries details" showIf="statusSelect >= 3" colSpan="6" onClick="action-view-show-stock-move-line"/>
	      <panel-dashlet name="customerDeliveriesPanel" title="Customer deliveries" showIf="statusSelect >= 3" colSpan="12" action="action-sale-order-view-stock-moves"/>
	    </panel>
	    <panel-dashlet name="saleOrderInvoicePanel" if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" title="Invoicing" showIf="statusSelect >= 2" action="action-view-show-invoices-from-sale-order"/>
	    <panel if="__config__.app.isApp('production')" if-module="axelor-production" name="productionPanel" title="Production" colSpan="12">
		  	<field name="productionNote" widget="Html" colSpan="12"/>
		  	<panel-dashlet name="manufOrdersPanel" action="action-sale-order-view-manuf-orders" colSpan="12"/>
	    </panel>
		<panel name="projectPanel" if="__config__.app.isApp('business-project') &amp;&amp; __config__.app.getApp('business-project').getGenerateProjectOrder()" title="Business project" colSpan="12" if-module="axelor-business-project">
			<field name="$_projectGeneratorType" title="Type of project's elements generated" x-enum-type="com.axelor.apps.project.db.ProjectGeneratorType" colSpan="6"/>
			<field name="$_elementStartDate" title="Start date" widget="date-time" colSpan="6" type="datetime"/>
			<field name="project" domain="self.clientPartner = :clientPartner" form-view="project-form" grid-view="project-grid" colSpan="6"/>
			<panel name="projectDetailsPanel" colSpan="6">
				<button name="updateLinesBtn" title="Update lines with selected project" onClick="save,action-business-project-sale-order-method-update-lines,save" readonlyIf="!project"/>
				<button name="fillProjectBtn" readonlyIf="!$_projectGeneratorType" title="Fill project" if="__config__.app.getApp('business-project').projectSaleOrderLines" showIf="project != null" hidden="true" onClick="save,action-business-project-method-fill-project" colSpan="12"/>
				<button name="generateProjectBtn" readonlyIf="!$_projectGeneratorType" title="Generate Project/Business" if="!__config__.app.getApp('business-project').automaticProject" showIf="project == null" hidden="true" onClick="save,action-business-project-method-generate-project" colSpan="12"/>
			</panel>
		</panel>
	    <panel if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').getAllowTimetableInvoicing()" if-module="axelor-supplychain" name="timetablePanel" title="Timetable">
	      <field name="expectedRealisationDate" colSpan="12" width="50%"/>
	      <label name="orLabel" title="OR"/>
	      <field name="amountToBeSpreadOverTheTimetable" colSpan="12"/>
	      <panel-related name="timetableListPanel"  if-module="axelor-supplychain" colSpan="12" field="timetableList" form-view="timetable-form" grid-view="timetable-grid" onChange="action-sale-order-method-update-amount-to-be-spread-over-the-timetable,action-supplychain-sale-order-validate-check-amount-timetable"/>
	    </panel>
	    <panel-related name="advancePaymentListPanel" if="__config__.app.isApp('supplychain') &amp;&amp; !__config__.app.getApp('account').getManageAdvancePaymentInvoice()" if-module="axelor-supplychain" readonly="true" colSpan="12" field="advancePaymentList" form-view="advance-payment-form" grid-view="advance-payment-grid"/>
	    <panel if="__config__.app.getApp('sale').getPrintingConfigPerSaleOrder()" name="printingPanel" title="Printing">
	      <field name="printingSettings" canEdit="false" onSelect="action-sale-method-filter-printing-settings"/>
	      <field name="hideDiscount"/>
	      <field name="specificNotes" readonly="true" showIf="specificNotes" colSpan="12"/>
	    </panel>
	    <panel-include if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').getAllowSusbcriptionSaleOrder()" if-module="axelor-supplychain" view="incl-sale-order-subscrption-form"/>
			<panel-dashlet if="__config__.app.isApp('supplychain')" name="generatedPurchaseOrderPanel" title="Generated purchase orders" action="action-sale-order-view-show-generated-po"/>
	  </panel-tabs>
	  <panel name="attrsPanel">
	    <field name="attrs" colSpan="12"/>
	  </panel>
	  <panel name="actionsPanel" hideIf="clientPartner == null" sidebar="true" stacked="true">
	    <button name="finalizeBtn" title="Finalize" showIf="statusSelect == 1" colSpan="12" onClick="action-group-sale-order-finalize-quotation"/>
	    <button if="(__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain')?.allowCompleteManuallySaleOrder) || (!__config__.app.isApp('supplychain'))" name="completeManuallySaleOrderBtn" title="Complete manually sale order" showIf="statusSelect == 3" prompt="Warning, a completed order can't be changed anymore, do you want to continue?" colSpan="12" onClick="save,action-sale-order-method-complete-sale-order"/>
	    <button if="__config__.app.getApp('sale').getManageSaleOrderVersion()" name="newVersionBtn" title="New version" showIf="statusSelect == 2" colSpan="12" onClick="save,action-sale-record-newVersion,save"/>
	    <button if="__config__.app.getApp('sale').allowPendingOrderModification" name="editOrderBtn" title="Edit order" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" colSpan="12" onClick="action-sale-order-method-edit-order"/>
	    <button name="validateChangesBtn" title="Validate changes" showIf="statusSelect == 3 &amp;&amp; orderBeingEdited" colSpan="12" onClick="action-group-sale-order-validate-changes"/>
	    <button if="__config__.app.getApp('supplychain')?.custStockMoveMgtOnSO &amp;&amp; !__config__.app.getApp('supplychain').customerStockMoveGenerationAuto" name="generateCustomerStockMoveBtn" title="Generate customer deliveries" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" readonlyIf="!saleOrderLineList || !saleOrderLineList.length" colSpan="12" onClick="save, action-supplychain-sale-order-create-stock-move"/>
	    <button name="confirmOrderBtn" title="Confirm order" showIf="statusSelect == 2" colSpan="12" onClick="save,action-sale-group-confirmed"/>
	    <button if="__config__.app.isApp('supplychain') &amp;&amp; __config__.app.getApp('supplychain').getGenerateInvoiceFromSaleOrder()" if-module="axelor-supplychain" name="generateInvoiceBtn" title="Generate invoice" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" colSpan="12" onClick="action-supplychain-sale-order-group-generate-invoice"/>
	    <button if="__config__.app.isApp('supplychain') &amp;&amp; !__config__.app.getApp('supplychain').getPurchaseOrderGenerationAuto()" name="generatePOBtn" title="Generate purchase order" showIf="(statusSelect == 2 || statusSelect == 3) &amp;&amp; !orderBeingEdited" colSpan="12" onClick="save,action-supplychain-sale-order-generate-purchase-orders-from-selected-SOLines"/>
	    <button if="__config__.app.getApp('production')?.prodOrderMgtOnSO &amp;&amp; !__config__.app.getApp('production')?.productionOrderGenerationAuto" name="generateProductionOrderBtn" title="Generate production order" showIf="statusSelect == 3 &amp;&amp; !orderBeingEdited" colSpan="12" onClick="save,action-sale-order-method-create-production-order"/>
	    <spacer name="btnSpacer"/>
	    <button name="cancelBtn" title="Cancel" css="btn-danger" icon="fa-times" showIf="id &amp;&amp; (statusSelect == 1 || statusSelect == 2)" colSpan="12" onClick="save,action-sale-order-view-cancel"/>
	    <button if="__config__.app.isApp('supplychain') &amp;&amp; !__config__.app.getApp('account').getManageAdvancePaymentInvoice()" if-module="axelor-supplychain" name="addAdvancePaymentBtn" title="Register a deposit" showIf="statusSelect == 3 &amp;&amp; amountInvoiced == 0" colSpan="12" onClick="save,action-sale-order-view-register-advance-payment"/>
	    <field name="message" hidden="true" type="string"/>
	    <field name="amountInvoiced" hidden="true"/>
	    <button if="__config__.app.getApp('sale').getEnableConfigurator()" name="addLineFromConfiguratorBtn" title="Add Line from Configurator" showIf="statusSelect == 1" onClick="save,action-sale-order-view-generate-line"/>
	  </panel>
	  <panel name="inTaxTotalPanel" readonly="true" hideIf="clientPartner == null" colSpan="4" sidebar="true">
	    <separator/>
	    <field name="inTaxTotal" showTitle="false" colSpan="12" css="order-subtotal">
	      <viewer depends="exTaxTotal,currency.symbol,taxTotal,statusSelect,amountInvoiced,advanceTotal"><![CDATA[

	                  <dl class="dl-horizontal">
	                      <dt x-translate>Total W.T.</dt>
	                      <dd>{{record.exTaxTotal}}  {{record.currency.symbol}}</dd>
	                      <dt x-translate>Total tax</dt>
	                      <dd>{{record.taxTotal}}  {{record.currency.symbol}}</dd>
	                      <dt class="order-subtotal-total" x-translate>Total A.T.I.</dt>
	                      <dd class="order-subtotal-total">{{record.inTaxTotal}}  {{record.currency.symbol}}</dd>
	                      <dt ng-show="record.statusSelect >= 3" x-translate>Amount invoiced W.T.</dt>
	                      <dd ng-show="record.statusSelect >= 3">{{record.amountInvoiced}}  {{record.currency.symbol}}</dd>
	                      <dt ng-show="record.statusSelect >= 2" x-translate>Advance payment total</dt>
	                      <dd ng-show="record.statusSelect >= 2">{{record.advanceTotal}}  {{record.currency.symbol}}</dd>
	                  </dl>

	              ]]></viewer>
	    </field>
	  </panel>
	  <panel name="salesFollowUpPanel" title="Sales follow-up" hideIf="clientPartner == null" sidebar="true" itemSpan="6" canCollapse="true" collapseIf="true">
	    <field name="salemanUser" canNew="false" canView="false" canEdit="false" form-view="user-form" grid-view="user-grid"/>
	    <field if="__config__.app.getApp('base').getTeamManagement()" name="team" canEdit="false" onSelect="action-sale-order-domain-on-team" form-view="team-form" grid-view="team-grid"/>
	  </panel>
	  <panel name="characteristicsPanel" title="Characteristics" hideIf="clientPartner == null" sidebar="true" itemSpan="6" canCollapse="true" collapseIf="true">
	    <panel name="paymentDetailsPanel" colSpan="12" if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain">
	      <field name="paymentMode" readonlyIf="statusSelect > 2" canEdit="false" onChange="action-sale-order-method-fill-company-bank-details" domain="self.inOutSelect = 1" form-view="payment-mode-form" grid-view="payment-mode-grid"/>
		    <field name="paymentCondition" readonlyIf="statusSelect > 2" canEdit="false" form-view="payment-condition-form" grid-view="payment-condition-grid"/>
	    </panel>
	    <field name="companyBankDetails" hidden="true" widget="SuggestBox" onSelect="com.axelor.apps.base.web.CompanyBankDetailsController:fillCompanyBankDetailsDomain" form-view="bank-details-form" grid-view="bank-details-grid"/>
	  </panel>
	  <panel name="referencePanel" title="References" hideIf="clientPartner == null" itemSpan="6" sidebar="true" canCollapse="true" collapseIf="true">
	    <field name="externalReference" hideIf="company == null" onChange="action-sale-order-attrs-external-reference"/>
	    <field name="opportunity" readonlyIf="statusSelect >= 2" form-view="opportunity-form" grid-view="opportunity-grid"/>
	    <field name="duplicateReferenceLabel" showTitle="false" readonly="true" hidden="true">
        <viewer>
          <![CDATA[
            <h5>
              <span ng-show="true" class='label label-warning' x-translate>Reference already existing</span>
            </h5>
          ]]>
        </viewer>
      </field>
	  </panel>
	  
	  <panel sidebar="true" title="GST Computation" itemSpan="6" >
			<field name="netAmount" colSpan="6" />
			<field name="netIgst" colSpan="6" />
			<field name="netCgst" colSpan="6" />
			<field name="netSgst" colSpan="6" />
			<field name="grossAmount" colSpan="6" />
		</panel>
	  <panel name="marginPanel" title="Margin" readonly="true" hideIf="clientPartner == null" itemSpan="6" sidebar="true" canCollapse="true" collapseIf="true">
	  	<field name="accountedRevenue">
	  		<hilite if="accountedRevenue &lt; companyExTaxTotal" color="warning"/>
	  	</field>
	    <field name="totalCostPrice"/>
	    <field name="totalGrossMargin">
	    	<hilite if="totalGrossMargin &lt; 0" color="danger"/>
	    </field>
	    <field name="marginRate">
	    	<hilite if="marginRate &lt; 0" color="danger"/>
	    </field>
	    <field name="markup">
	    	<hilite if="markup &lt; 0" color="danger"/>
	    </field>
	    <field name="company.currency" title="Company currency" readonly="true"/>
	  </panel>
	  <panel name="datesPanel" title="Dates" hideIf="clientPartner == null" sidebar="true" canCollapse="true" collapseIf="true">
	    <field name="creationDate" readonlyIf="statusSelect != 1" colSpan="6" onChange="action-sale-order-record-compute-end-of-validity-date"/>
	    <field name="confirmedByUser" readonly="true" showIf="statusSelect == 3" colSpan="6" canNew="false" canView="false" canEdit="false" form-view="user-form" grid-view="user-grid"/>
	    <field name="confirmationDateTime" readonly="true" showIf="statusSelect == 3" colSpan="6"/>
	    <field name="orderDate" showIf="statusSelect == 3" colSpan="6"/>
	    <field name="orderNumber" showIf="statusSelect == 3" colSpan="6"/>
	    <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" name="shipmentDate" showIf="statusSelect == 3" colSpan="6"/>
	    <field name="duration" readonlyIf="statusSelect >= 2" colSpan="6" widget="SuggestBox" canNew="true" onChange="action-sale-order-record-compute-end-of-validity-date"/>
	    <field name="endOfValidityDate" readonly="true" colSpan="6">
	      <hilite color="danger" if="$moment().diff(endOfValidityDate, 'days') > 0 &amp;&amp; statusSelect != 3"/>
	    </field>
	    <field if="__config__.app.isApp('supplychain') &amp;&amp; !__config__.app.getApp('supplychain').getAllowTimetableInvoicing()" name="expectedRealisationDate" colSpan="6"/>
	    <field name="cancelReason" hidden="true"/>
	    <field name="cancelReasonStr" title="Cancel Reason" hidden="true" readonly="true" showIf="cancelReason != null &amp;&amp; cancelReasonStr != null" colSpan="12" css="red">
	      <viewer><![CDATA[{{record.cancelReasonStr}}]]></viewer>
	    </field>
	    <field if="__config__.app.isApp('supplychain')" if-module="axelor-supplychain" name="standardDelay" hidden="true" readonly="true" showIf="standardDelay > 0"/>
	  </panel>
	  <panel name="internalNotePanel" title="Internal Note" colSpan="12" sidebar="true">
	    <field name="internalNote" showTitle="false" colSpan="12" widget="Html" x-lite="true"/>
	  </panel>
	  <panel-mail name="mailPanel">
	    <mail-messages limit="4"/>
	    <mail-followers/>
	  </panel-mail>
	</form>


	<form name="sale-order-form-client" title="Sale order"
		model="com.axelor.apps.sale.db.SaleOrder" id="sale-order-form-client"
		onLoad="action-group-sale-saleorder-onload" onSave="save,action-sale-order-method-compute,save"
		onNew="action-group-sale-saleorder-onnew" width="large">
	  <toolbar>
	    <button name="printBtn" title="Print" icon="fa-print" onClick="save,action-sale-order-method-show-sale-order"/>
	  </toolbar>
	  <panel name="mainPanel" readonly="true">
	    <field name="saleOrderSeq" css="highlight"/>
	    <field name="company" canEdit="false" widget="SuggestBox" form-view="company-form" grid-view="company-grid"/>
	    <field name="externalReference"/>
	    <field name="currency" canEdit="false" form-view="currency-form" grid-view="currency-grid"/>
	  </panel>
		<panel-tabs readonly="true" name="mainPanelTab">
			<panel name="customerInformationPanel" title="Customer information" showTitle="false">
				<field name="clientPartner" form-view="partner-form" grid-view="partner-grid" canView="false" domain=":company member of self.companySet"/>
				<panel stacked="true" name="mainInvoicingAddressPanel">
					<field name="mainInvoicingAddress" canNew="true"
						   hideIf="$readonly() || statusSelect &gt; 1"
						   onChange="action-sale-order-method-address-str"
						   onSelect="action-sale-order-attrs-domain-main-invoicing-address"
						   form-view="address-partner-address-form"
						   grid-view="address-grid"/>
					<field name="mainInvoicingAddressStr" readonlyIf="statusSelect &gt; 1" height="5">
						<viewer>{{record.mainInvoicingAddressStr}}</viewer>
					</field>
				</panel>

	      <field name="contactPartner" domain="self.isContact = true AND :company member of self.companySet" form-view="partner-contact-form" grid-view="partner-contact-grid" canView="false"/>
				<panel stacked="true" name="deliveryAddressPanel">
					<field name="deliveryAddress" canNew="true"
						   hideIf="$readonly() || statusSelect &gt; 1"
						   onChange="action-sale-order-method-address-str"
						   onSelect="action-sale-order-attrs-domain-delivery-address"
						   form-view="address-partner-address-form"
						   grid-view="address-grid"/>
					<field name="deliveryAddressStr" readonlyIf="statusSelect &gt; 1" height="5">
						<viewer>{{record.deliveryAddressStr}}</viewer>
					</field>
				</panel>
	      <panel name="detailsPanel" colSpan="8">
	        <field name="confirmationDateTime"/>
	        <field name="creationDate"/>
	        <field name="orderDate"/>
	        <field name="shipmentDate" if-module="axelor-supplychain" if="__config__.app.isApp('supplychain')" />
	        <field name="duration"/>
	        <field name="endOfValidityDate">
	    		<hilite if="$moment().diff(endOfValidityDate, 'days') &gt; 0 &amp;&amp; statusSelect != 3" color="danger"/>
	    	</field>
	        <field name="salemanUser" canNew="false" canEdit="false" colSpan="10" form-view="user-form" grid-view="user-grid" canView="false"/>
	        <field name="statusSelect" widget="NavSelect" colSpan="12"/>
	      </panel>
            <panel name="inTaxTotalPanel" readonly="true"  css="order-subtotal" colSpan="4">
                <field name="inTaxTotal" showTitle="false" colSpan="12">
                    <viewer depends="exTaxTotal,currency.symbol,taxTotal,statusSelect,amountInvoiced,advanceTotal">
                        <![CDATA[
                        <dl class="dl-horizontal">
                            <dt x-translate>Total W.T.</dt>
                            <dd>{{record.exTaxTotal}} {{record.currency.symbol}}</dd>
                            <dt x-translate>Total V.A.T.</dt>
                            <dd>{{record.taxTotal}} {{record.currency.symbol}}</dd>
                            <dt class="order-subtotal-total" x-translate>Total A.T.I.</dt>
                            <dd class="order-subtotal-total">{{record.inTaxTotal}} {{record.currency.symbol}}</dd>
                            <dt ng-show="record.statusSelect >= 3" x-translate>Amount invoiced W.T.</dt>
                            <dd ng-show="record.statusSelect >= 3">{{record.amountInvoiced}}  {{record.currency.symbol}}</dd>
                            <dt ng-show="record.statusSelect >= 2" x-translate>Advance payment total</dt>
                            <dd ng-show="record.statusSelect >= 2">{{record.advanceTotal}}  {{record.currency.symbol}}</dd>
                        </dl>
                        ]]>
                    </viewer>
                </field>
            </panel>
	    </panel>
	    <panel-related name="saleOrderLineListPanel" field="saleOrderLineList" showTitle="false" form-view="sale-order-line-form" grid-view="sale-order-line-grid" canMove="true" orderBy="sequence"/>
	    <panel-related name="saleOrderLineTaxListPanel" field="saleOrderLineTaxList" showTitle="false" form-view="sale-order-line-tax-form" grid-view="sale-order-line-tax-grid"/>
	    <panel-dashlet name="invoicesFromSOPanel" action="action-view-show-invoices-from-sale-order" title="Invoicing"/>
	  </panel-tabs>
	</form>


</object-views>
